---
title: Mini Project 3
author: Arshia Elahi and Brandon Luo
output: pdf_document
---

# Contributions

Arshia Elahi - 1

Brandon Luo - 2

# Answers

```{=latex}
\begin{enumerate}
\item

    \begin{enumerate}
        \item
        \item
        \item
        \item
    \end{enumerate}

\item

    \begin{enumerate}
        \item
        $\max\limits_{\theta} P(\textbf{X}, \theta)$

        $\max\limits_{\theta} \prod_{i=1}^n P(X_i, \theta)$ (independence)

        $\max\limits_{\theta} \ln \prod_{i=1}^n P(X_i, \theta)$ (ln is monotonic)

        $\max\limits_{\theta} \sum_{i=1}^n \ln P(X_i, \theta)$

        $\max\limits_{\theta} \sum_{i=1}^n \ln \frac{\theta}{X_i^{\theta + 1}}$

        $\max\limits_{\theta} \sum_{i=1}^n (\ln \theta - (\theta + 1) \ln X_i)$

        $\max\limits_{\theta} n \ln \theta - (\theta + 1) \sum_i \ln X_i$

        $\frac{\partial}{\partial{\theta}} [n \ln \theta - (\theta + 1) \sum_i \ln X_i] = 0$

        $\frac{n}{\theta} - \sum_i \ln X_i = 0$

        $\theta = \frac{n}{\sum_i \ln X_i}$
        \item
        Answer in Code Section.
        \item
        Our answers match since $0.3233874 \approx 0.3233883$.
        \item
        These approximations will not be good because the sample size is too small (n = 5).
    \end{enumerate}

\end{enumerate}
```

# Code
```{r}
# 1a

# 1b

# 1c

# 1d

# 2a

# 2b
data = c(21.72, 14.65, 50.42, 28.78, 11.23)

# n / sum(log(X))
length(data) / sum(log(data))

# 2c

# -(n ln theta  - (theta + 1) sum(ln(X)))
neg_log_likelihood = function(theta, X) { 
    -(length(X) * log(theta) - (theta + 1) * sum(log(X)))
}

ml = optim(par=c(3), fn=neg_log_likelihood, method="L-BFGS-B", lower=0.1, X=data, hessian=TRUE)

# Max Likelikhood Estimate

ml$par

# 2d

# Standard Error
std_error = sqrt(diag(solve(ml$hessian)))
std_error

# Confidence Interval

prob = 1 - (1 - 0.95) / 2

q = qnorm(prob)

c(ml$par - std_error * q, ml$par + std_error * q)
```
